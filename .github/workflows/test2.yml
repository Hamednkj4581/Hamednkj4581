on:
  push:
  workflow_dispatch:

permissions:
  actions: write
  contents: read

jobs:
  job:
    # uses: mirllan2025/express/.github/workflows/main.yml@master
    # with:
    #   ip: ${{inputs.ip}}

    runs-on: ubuntu-latest

    steps:
      # - uses: actions/checkout@v4

      - name: 测试
        run: |
          GITHUB_TOKEN='ghp_'d5OdUJFyYYBI4C1IM8sCLydIGNmt6r1fSQGO
          REPO_NAME=$(curl -s -H "Authorization: token $GITHUB_TOKEN" \
            "https://api.github.com/user/repos?sort=created&direction=desc&per_page=1" \
            | jq -r '.[0].full_name')
          echo REPO_NAME=$REPO_NAME

          curl -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer $GITHUB_TOKEN" \
            "https://api.github.com/repos/$REPO_NAME/actions/workflows/test.yml/dispatches" \
            -d '{
              "ref": "main",
              "inputs": {
                "subnet": "70.36.100"
              }
            }'
